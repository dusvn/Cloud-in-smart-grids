DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:24:15] Starting DiagnosticPlugin.exe DiagnosticPlugin-ShutdownEvent DiagnosticPlugin-TotalShutdownEvent -wadVer1v5
DiagnosticsPlugin.exe Error: 0 : [17.5.2024. 21:24:16] Failed to save IIS Directory state
DiagnosticsPlugin.exe Error: 0 : [17.5.2024. 21:24:16] System.Runtime.InteropServices.COMException (0x80040154): Retrieving the COM class factory for component with CLSID {2B72133B-3F5B-4602-8952-803546CE3344} failed due to the following error: 80040154 Class not registered (Exception from HRESULT: 0x80040154 (REGDB_E_CLASSNOTREG)).
   at System.Runtime.Remoting.RemotingServices.AllocateUninitializedObject(RuntimeType objectType)
   at System.Runtime.Remoting.Activation.ActivationServices.CreateInstance(RuntimeType serverType)
   at System.Runtime.Remoting.Activation.ActivationServices.IsCurrentContextOK(RuntimeType serverType, Object[] props, Boolean bNewObj)
   at System.RuntimeTypeHandle.CreateInstance(RuntimeType type, Boolean publicOnly, Boolean noCheck, Boolean& canBeCached, RuntimeMethodHandleInternal& ctor, Boolean& bNeedSecurityCheck)
   at System.RuntimeType.CreateInstanceSlow(Boolean publicOnly, Boolean skipCheckThis, Boolean fillCache, StackCrawlMark& stackMark)
   at System.Activator.CreateInstance[T]()
   at Microsoft.Web.Administration.ConfigurationManager.CreateAdminManager[TClass,TInterface](WebConfigurationMap webConfigMap, Boolean isAdminConfig, Boolean isRedirectionConfig)
   at Microsoft.Web.Administration.ConfigurationManager.CreateWritableAdminManager(WebConfigurationMap webConfigMap, String configPathToEdit, Boolean isAdminConfig, Boolean isRedirectionConfig)
   at Microsoft.Web.Administration.ConfigurationManager.CreateConfiguration(WebConfigurationMap configMap, String configPathToEdit, Boolean isAdminConfig, Boolean isRedirectionConfig)
   at Microsoft.Web.Administration.ConfigurationManager.GetConfiguration(String rawConfigurationPath, String cacheKey, Boolean isAdminConfig, Boolean isRedirectionConfig)
   at Microsoft.Web.Administration.ConfigurationManager.GetApplicationHostConfiguration()
   at Microsoft.Web.Administration.ServerManager.SitesSectionCreator()
   at Microsoft.Web.Administration.Lazy.Initialize[T](T& target, CreateInstanceDelegate`1 valueFactory)
   at Microsoft.Web.Administration.ServerManager.SitesCollectionCreator()
   at Microsoft.Web.Administration.Lazy.Initialize[T](T& target, CreateInstanceDelegate`1 valueFactory)
   at Microsoft.Azure.Plugins.Plugin.DiagnosticsPluginManager.SaveIISDirectoryState()
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:24:16] Starting DiagnosticsPlugin
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:24:16] Emulator config file set to C:\Users\Jovan\Desktop\RedditProject\Reddit\Reddit\csx\Debug\roles\HealthMonitoringService\approot\diagnostics.wadcfgx
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:24:16] DiagnosticsStoreRootPath set to: C:\Users\Jovan\Desktop\RedditProject\Reddit\Reddit\csx\Debug\roles\HealthMonitoringService\approot
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:24:16] Loading config file: C:\Users\Jovan\Desktop\RedditProject\Reddit\Reddit\csx\Debug\roles\HealthMonitoringService\approot\diagnostics.wadcfgx
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:24:16] Config file to read: C:\Users\Jovan\Desktop\RedditProject\Reddit\Reddit\csx\Debug\roles\HealthMonitoringService\approot\diagnostics.wadcfgx
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:24:16] Checking VM Type
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:24:16] Emulator config file set to C:\Users\Jovan\Desktop\RedditProject\Reddit\Reddit\csx\Debug\roles\HealthMonitoringService\approot\diagnostics.wadcfgx
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:24:16] Extension set to Emulator Mode
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:24:16] Reading XML configuration file
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:24:16] Bypassing private config decryption
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:24:16] WadCfg is provided in initial configuration. Using that to initialize Diagnostics.
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:24:16] <PublicConfig xmlns="http://schemas.microsoft.com/ServiceHosting/2010/10/DiagnosticsConfiguration">
  <WadCfg>
    <DiagnosticMonitorConfiguration overallQuotaInMB="4096">
      <DiagnosticInfrastructureLogs scheduledTransferLogLevelFilter="Error" />
      <Logs scheduledTransferPeriod="PT1M" scheduledTransferLogLevelFilter="Error" />
      <Directories scheduledTransferPeriod="PT1M">
        <IISLogs containerName="wad-iis-logfiles" />
        <FailedRequestLogs containerName="wad-failedrequestlogs" />
      </Directories>
      <WindowsEventLog scheduledTransferPeriod="PT1M">
        <DataSource name="Application!*[System[(Level=1 or Level=2 or Level=3)]]" />
        <DataSource name="Windows Azure!*[System[(Level=1 or Level=2 or Level=3 or Level=4)]]" />
      </WindowsEventLog>
      <CrashDumps containerName="wad-crashdumps" dumpType="Mini">
        <CrashDumpConfiguration processName="WaIISHost.exe" />
        <CrashDumpConfiguration processName="WaWorkerHost.exe" />
        <CrashDumpConfiguration processName="w3wp.exe" />
      </CrashDumps>
      <PerformanceCounters scheduledTransferPeriod="PT1M">
        <PerformanceCounterConfiguration counterSpecifier="\Memory\Available MBytes" sampleRate="PT3M" />
        <PerformanceCounterConfiguration counterSpecifier="\Web Service(_Total)\ISAPI Extension Requests/sec" sampleRate="PT3M" />
        <PerformanceCounterConfiguration counterSpecifier="\Web Service(_Total)\Bytes Total/Sec" sampleRate="PT3M" />
        <PerformanceCounterConfiguration counterSpecifier="\ASP.NET Applications(__Total__)\Requests/Sec" sampleRate="PT3M" />
        <PerformanceCounterConfiguration counterSpecifier="\ASP.NET Applications(__Total__)\Errors Total/Sec" sampleRate="PT3M" />
        <PerformanceCounterConfiguration counterSpecifier="\ASP.NET\Requests Queued" sampleRate="PT3M" />
        <PerformanceCounterConfiguration counterSpecifier="\ASP.NET\Requests Rejected" sampleRate="PT3M" />
        <PerformanceCounterConfiguration counterSpecifier="\Processor(_Total)\% Processor Time" sampleRate="PT3M" />
      </PerformanceCounters>
    </DiagnosticMonitorConfiguration>
  </WadCfg>
  <StorageAccount>devstoreaccount1</StorageAccount>
</PublicConfig>
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:24:16] Private setting is loaded
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:24:16] Is config json/xml loaded
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:24:16] Checking if configuration needs to be fetched from the storage account and doing so if needed.
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:24:17] Successfully created checkpoint file C:\Users\Jovan\Desktop\RedditProject\Reddit\Reddit\csx\Debug\roles\HealthMonitoringService\approot\WAD0105\Configuration\Checkpoint.txt
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:24:17] Will use local resource directory C:\Users\Jovan\Desktop\RedditProject\Reddit\Reddit\csx\Debug\roles\HealthMonitoringService\approot\WAD0105
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:24:18] Will use endpoint https://core.windows.net for storage.
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:24:19] Exception in creating the ServerManager; is IIS installed?
 Error:System.Runtime.InteropServices.COMException (0x80040154): Retrieving the COM class factory for component with CLSID {2B72133B-3F5B-4602-8952-803546CE3344} failed due to the following error: 80040154 Class not registered (Exception from HRESULT: 0x80040154 (REGDB_E_CLASSNOTREG)).
   at System.Runtime.Remoting.RemotingServices.AllocateUninitializedObject(RuntimeType objectType)
   at System.Runtime.Remoting.Activation.ActivationServices.CreateInstance(RuntimeType serverType)
   at System.Runtime.Remoting.Activation.ActivationServices.IsCurrentContextOK(RuntimeType serverType, Object[] props, Boolean bNewObj)
   at System.RuntimeTypeHandle.CreateInstance(RuntimeType type, Boolean publicOnly, Boolean noCheck, Boolean& canBeCached, RuntimeMethodHandleInternal& ctor, Boolean& bNeedSecurityCheck)
   at System.RuntimeType.CreateInstanceSlow(Boolean publicOnly, Boolean skipCheckThis, Boolean fillCache, StackCrawlMark& stackMark)
   at System.Activator.CreateInstance[T]()
   at Microsoft.Web.Administration.ConfigurationManager.CreateAdminManager[TClass,TInterface](WebConfigurationMap webConfigMap, Boolean isAdminConfig, Boolean isRedirectionConfig)
   at Microsoft.Web.Administration.ConfigurationManager.CreateWritableAdminManager(WebConfigurationMap webConfigMap, String configPathToEdit, Boolean isAdminConfig, Boolean isRedirectionConfig)
   at Microsoft.Web.Administration.ConfigurationManager.CreateConfiguration(WebConfigurationMap configMap, String configPathToEdit, Boolean isAdminConfig, Boolean isRedirectionConfig)
   at Microsoft.Web.Administration.ConfigurationManager.GetConfiguration(String rawConfigurationPath, String cacheKey, Boolean isAdminConfig, Boolean isRedirectionConfig)
   at Microsoft.Web.Administration.ConfigurationManager.GetApplicationHostConfiguration()
   at Microsoft.Web.Administration.ServerManager.SitesSectionCreator()
   at Microsoft.Web.Administration.Lazy.Initialize[T](T& target, CreateInstanceDelegate`1 valueFactory)
   at Microsoft.Web.Administration.ServerManager.SitesCollectionCreator()
   at Microsoft.Web.Administration.Lazy.Initialize[T](T& target, CreateInstanceDelegate`1 valueFactory)
   at Microsoft.Azure.Plugins.Plugin.WadConfigProcessor.AddDirectories(EventsType mdsEvents, Directories wadDirectories)
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:24:19] Running in emulator mode, crash dumps not enabled
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:24:19] Checking to see if Application Insights extension needs to be configured.
DiagnosticsPlugin.exe Error: 0 : [17.5.2024. 21:24:19] Encountered a problem while writing the file: System.IO.IOException: The process cannot access the file 'C:\Users\Jovan\Desktop\RedditProject\Reddit\Reddit\csx\Debug\roles\HealthMonitoringService\approot\WAD0105\Configuration\MaConfig.xml' because it is being used by another process.
   at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   at System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs, String msgPath, Boolean bFromProxy, Boolean useLongPath, Boolean checkHost)
   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options, String msgPath, Boolean bFromProxy)
   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, Boolean useAsync)
   at System.Xml.XmlWriterSettings.CreateWriter(String outputFileName)
   at Microsoft.Azure.Plugins.Plugin.BaseMonitoringConfig.WriteFile(MonitoringManagement config, String outFile)
DiagnosticsPlugin.exe Error: 0 : [17.5.2024. 21:24:19] Retrying after 2 seconds
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:24:22] In emulator mode and using devstore updating XStoreAccount info, command line args: -LocalPath "C:\Users\Jovan\Desktop\RedditProject\Reddit\Reddit\csx\Debug\roles\HealthMonitoringService\approot\WAD0105"  -ConfigFile "C:\Users\Jovan\Desktop\RedditProject\Reddit\Reddit\csx\Debug\roles\HealthMonitoringService\approot\WAD0105\Configuration\MaConfig.xml" -ShutDownEvent WADDM-ShutDown-6d203d15df084ad6b6f9b2734a351e23  -TotalShutDownEvent WADDM-TotalShutDown-6d203d15df084ad6b6f9b2734a351e23 -InitializedEvent WADM-StartUp-6d203d15df084ad6b6f9b2734a351e23 -parent 6960 -events -wadVer1v5 -UseProxyServer -XStoreAccounts WadAccount#true#devstoreaccount1#Eby8vdM02xNOcqFlqUwJPLlmEtlCDXJ1OUzFT50uSRZ6IFsuFq2UVErCz4I6tq/K1SZFPTOtr/KBHBeksoGMGw==#http://127.0.0.1:10002#http://127.0.0.1:10001#http://127.0.0.1:10000
DiagnosticsPlugin.exe Error: 0 : [17.5.2024. 21:24:52] Microsoft.Cis.Monitoring.Query.QueryException: ErrorFail
   at Microsoft.Cis.Monitoring.Query.QueryLocalTable..ctor(String TableName, String TablePath)
   at ApplicationInsightsExtension.MATableReader.ReadTableRecords(String tableName, String tablePath, DateTime startTime, DateTime endTime)
   at Microsoft.Azure.Plugins.Diagnostics.dll.MAStatusWriter.UpdateStatusReport(Object sender, ElapsedEventArgs e)
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:25:22] MonAgentHost.exe started
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:25:22] DiagnoticsPlugin started.
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:25:22] DiagnoticsPlugin now waiting on events "DiagnosticPlugin-ShutdownEvent", "DiagnosticPlugin-TotalShutdownEvent" or "DiagnosticPlugin-RestartEvent".
DiagnosticsPlugin.exe Error: 0 : [17.5.2024. 21:25:22] Microsoft.Cis.Monitoring.Query.QueryException: ErrorFail
   at Microsoft.Cis.Monitoring.Query.QueryLocalTable..ctor(String TableName, String TablePath)
   at ApplicationInsightsExtension.MATableReader.ReadTableRecords(String tableName, String tablePath, DateTime startTime, DateTime endTime)
   at Microsoft.Azure.Plugins.Diagnostics.dll.MAStatusWriter.UpdateStatusReport(Object sender, ElapsedEventArgs e)
DiagnosticsPlugin.exe Error: 0 : [17.5.2024. 21:25:52] Microsoft.Cis.Monitoring.Query.QueryException: ErrorFail
   at Microsoft.Cis.Monitoring.Query.QueryLocalTable..ctor(String TableName, String TablePath)
   at ApplicationInsightsExtension.MATableReader.ReadTableRecords(String tableName, String tablePath, DateTime startTime, DateTime endTime)
   at Microsoft.Azure.Plugins.Diagnostics.dll.MAStatusWriter.UpdateStatusReport(Object sender, ElapsedEventArgs e)
DiagnosticsPlugin.exe Information: 0 : [17.5.2024. 21:26:16] Failed to update IIS Directory state in directory monitor
Retrieving the COM class factory for component with CLSID {2B72133B-3F5B-4602-8952-803546CE3344} failed due to the following error: 80040154 Class not registered (Exception from HRESULT: 0x80040154 (REGDB_E_CLASSNOTREG)).
DiagnosticsPlugin.exe Error: 0 : [17.5.2024. 21:26:22] Microsoft.Cis.Monitoring.Query.QueryException: ErrorFail
   at Microsoft.Cis.Monitoring.Query.QueryLocalTable..ctor(String TableName, String TablePath)
   at ApplicationInsightsExtension.MATableReader.ReadTableRecords(String tableName, String tablePath, DateTime startTime, DateTime endTime)
   at Microsoft.Azure.Plugins.Diagnostics.dll.MAStatusWriter.UpdateStatusReport(Object sender, ElapsedEventArgs e)
DiagnosticsPlugin.exe Error: 0 : [17.5.2024. 21:26:52] Microsoft.Cis.Monitoring.Query.QueryException: ErrorFail
   at Microsoft.Cis.Monitoring.Query.QueryLocalTable..ctor(String TableName, String TablePath)
   at ApplicationInsightsExtension.MATableReader.ReadTableRecords(String tableName, String tablePath, DateTime startTime, DateTime endTime)
   at Microsoft.Azure.Plugins.Diagnostics.dll.MAStatusWriter.UpdateStatusReport(Object sender, ElapsedEventArgs e)
DiagnosticsPlugin.exe Error: 0 : [17.5.2024. 21:27:22] Microsoft.Cis.Monitoring.Query.QueryException: ErrorFail
   at Microsoft.Cis.Monitoring.Query.QueryLocalTable..ctor(String TableName, String TablePath)
   at ApplicationInsightsExtension.MATableReader.ReadTableRecords(String tableName, String tablePath, DateTime startTime, DateTime endTime)
   at Microsoft.Azure.Plugins.Diagnostics.dll.MAStatusWriter.UpdateStatusReport(Object sender, ElapsedEventArgs e)
